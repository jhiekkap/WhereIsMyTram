{"ast":null,"code":"var _jsxFileName = \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/components/LeafletMap.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { setShowTrams } from '../reducers/showTramsReducer';\nimport { setMyTram } from '../reducers/myTramReducer';\nimport { setCenter, setZoom, setShowAlert, openSidebar, closeSidebar, setLine, setAlarm } from '../reducers/settingsReducer';\nimport { setMyStop } from '../reducers/myStopReducer';\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet';\nimport { Button, Alert } from 'react-bootstrap';\nimport driverIcon, { stopIcon, myStopIcon, tramIcon, myTramIcon, locationIcon } from '../utils/icons';\nimport { printDuration } from '../utils/helpers';\nimport alarmOnButton from '../img/iconfinder_Circle_Red_34214.png';\nimport alarmOffButton from '../img/iconfinder_stop_green_61688.png';\n\nconst LeafletMap = ({\n  trams,\n  showTrams,\n  setShowTrams,\n  openSidebar,\n  closeSidebar,\n  setCenter,\n  setZoom,\n  stops,\n  myStop,\n  setMyStop,\n  myTram,\n  setMyTram,\n  settings,\n  setShowAlert,\n  setLine,\n  setAlarm\n}) => {\n  const handleChooseTram = e => {\n    console.log('valitse nro: ', e.target.value);\n    let chosenTram = trams.find(tram => tram.VP.veh == e.target.value); //setShowTrams([])\n\n    setMyTram(chosenTram);\n    setLine(chosenTram.VP.desi);\n\n    if (!showTrams.map(tram => tram.VP.veh).includes(chosenTram.VP.veh)) {\n      setShowTrams(showTrams.concat(chosenTram));\n    }\n\n    setCenter({\n      lat: chosenTram.VP.lat,\n      lng: chosenTram.VP.long\n    }); //setZoom(16)\n  };\n\n  const popUp = tram => {\n    return React.createElement(Popup, {\n      closeButton: true,\n      value: tram.VP.veh,\n      autoPan: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, \"line:\", tram.VP.desi, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }), \"vehicle:\", tram.VP.veh, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }), \"speed:\", (tram.VP.spd * 3.6).toFixed(2), \" km/h\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }), \"stop:\", tram.VP.stop, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }), \"route:\", tram.VP.route, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }), tram.VP.dl > 0 ? 'ahead ' : 'lagging ', \" \", Math.abs(tram.VP.dl), \" seconds\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }), tram.VP.drst === 0 ? 'doors closed' : 'doors open', React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }), (!myTram.VP || myTram.VP && myTram.VP.veh !== tram.VP.veh) && React.createElement(Button, {\n      value: tram.VP.veh,\n      onClick: handleChooseTram,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \"CHOOSE\"));\n  };\n\n  const ShowChosenTrams = () => {\n    let tramsToShow = [...trams].filter(tram => showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh));\n\n    if (showTrams) {\n      return tramsToShow.map((tram, i) => React.createElement(Marker, {\n        key: i,\n        icon: myTram.VP && myTram.VP.veh === tram.VP.veh ? myTramIcon : tramIcon,\n        position: {\n          lat: tram.VP.lat,\n          lng: tram.VP.long\n        },\n        zIndex: 2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, popUp(tram)));\n    }\n  };\n\n  const showStops = () => {\n    return stops && stops.map((stop, i) => React.createElement(Marker, {\n      onClick: () => setMyStop(stop),\n      key: i,\n      icon: stop.id === myStop.id ? myStopIcon : stopIcon,\n      position: {\n        lat: stop.lat,\n        lng: stop.lon\n      },\n      zIndex: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Popup, {\n      autoPan: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }), \" \", stop.name, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }), \" \", stop.gtfsId)));\n  };\n\n  const style = settings.showSidebar ? {\n    marginLeft: '20px'\n  } : {\n    marginLeft: '0'\n  };\n  return React.createElement(\"div\", {\n    id: \"mapContainer\",\n    style: style,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, settings.showSidebarOpenButton && React.createElement(Button, {\n    id: \"sidebarButton\",\n    variant: \"light\",\n    style: {\n      display: settings.showSidebar ? 'none' : ''\n    },\n    onClick: () => openSidebar(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, settings.showSidebarOpenButton ? '☰' : ''), myTram && React.createElement(\"div\", {\n    id: \"distanceOnMap\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, settings.distance, \" m\"), myTram && React.createElement(\"div\", {\n    id: \"durationOnMap\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, settings.avgDuration > 0 && printDuration(settings.avgDuration)), myTram && React.createElement(\"div\", {\n    id: \"alarmButtonOnMap\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: settings.alarm ? alarmOffButton : alarmOnButton,\n    onClick: () => setAlarm(!settings.alarm),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  })), !settings.showAlert && React.createElement(Map, {\n    id: \"map\",\n    center: settings.center,\n    zoom: settings.zoom,\n    onclick: () => closeSidebar(),\n    zoomControl: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(TileLayer, {\n    url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n    attribution: \"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }), ShowChosenTrams(), showStops(), React.createElement(Marker, {\n    icon: driverIcon,\n    position: {\n      lat: 60.170627,\n      lng: 24.939946\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(Popup, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \"We are here! \", React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }), \" This is our position!\"))), React.createElement(Alert, {\n    id: \"alert\",\n    show: settings.showAlert,\n    variant: settings.alertVariant ? 'danger' : 'warning',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }), React.createElement(Alert.Heading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, \"How's it going?!\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, \"Duis mollis, est non commodo luctus\"), React.createElement(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"d-flex justify-content-end\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, React.createElement(Button, {\n    onClick: () => setShowAlert(false),\n    variant: \"warning\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, \"Close me ya'll!\"))));\n};\n\nconst mapStateToProps = state => {\n  return {\n    trams: state.trams,\n    showTrams: state.showTrams,\n    //showSidebar: state.showSidebar,\n    showSidebarOpenButton: state.showSidebarOpenButton,\n    stops: state.stops,\n    settings: state.settings,\n    myStop: state.myStop,\n    myTram: state.myTram\n  };\n};\n\nconst mapDispatchToProps = {\n  setShowTrams,\n  setMyStop,\n  setMyTram,\n  setZoom,\n  setCenter,\n  setShowAlert,\n  openSidebar,\n  closeSidebar,\n  setLine,\n  setAlarm\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(LeafletMap);","map":{"version":3,"sources":["/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/components/LeafletMap.js"],"names":["React","connect","setShowTrams","setMyTram","setCenter","setZoom","setShowAlert","openSidebar","closeSidebar","setLine","setAlarm","setMyStop","Map","Marker","Popup","TileLayer","Button","Alert","driverIcon","stopIcon","myStopIcon","tramIcon","myTramIcon","locationIcon","printDuration","alarmOnButton","alarmOffButton","LeafletMap","trams","showTrams","stops","myStop","myTram","settings","handleChooseTram","e","console","log","target","value","chosenTram","find","tram","VP","veh","desi","map","includes","concat","lat","lng","long","popUp","spd","toFixed","stop","route","dl","Math","abs","drst","ShowChosenTrams","tramsToShow","filter","i","showStops","id","lon","name","gtfsId","style","showSidebar","marginLeft","showSidebarOpenButton","display","distance","avgDuration","alarm","showAlert","center","zoom","alertVariant","mapStateToProps","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { connect } from 'react-redux'\nimport { setShowTrams } from '../reducers/showTramsReducer'\nimport { setMyTram } from '../reducers/myTramReducer'\nimport {\n  setCenter,\n  setZoom,\n  setShowAlert,\n  openSidebar,\n  closeSidebar,\n  setLine,\n  setAlarm,\n} from '../reducers/settingsReducer'\nimport { setMyStop } from '../reducers/myStopReducer'\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet'\nimport { Button, Alert } from 'react-bootstrap'\nimport driverIcon, {\n  stopIcon,\n  myStopIcon,\n  tramIcon,\n  myTramIcon,\n  locationIcon,\n} from '../utils/icons'\nimport { printDuration } from '../utils/helpers'\nimport alarmOnButton from '../img/iconfinder_Circle_Red_34214.png'\nimport alarmOffButton from '../img/iconfinder_stop_green_61688.png'\n\nconst LeafletMap = ({\n  trams,\n  showTrams,\n  setShowTrams,\n  openSidebar,\n  closeSidebar,\n  setCenter,\n  setZoom,\n  stops,\n  myStop,\n  setMyStop,\n  myTram,\n  setMyTram,\n  settings,\n  setShowAlert,\n  setLine,\n  setAlarm,\n}) => {\n  const handleChooseTram = e => {\n    console.log('valitse nro: ', e.target.value)\n    let chosenTram = trams.find(tram => tram.VP.veh == e.target.value)\n    //setShowTrams([])\n    setMyTram(chosenTram)\n    setLine(chosenTram.VP.desi)\n    if (!showTrams.map(tram => tram.VP.veh).includes(chosenTram.VP.veh)) {\n      setShowTrams(showTrams.concat(chosenTram))\n    }\n    setCenter({ lat: chosenTram.VP.lat, lng: chosenTram.VP.long })\n    //setZoom(16)\n  }\n\n  const popUp = tram => {\n    return (\n      <Popup closeButton={true} value={tram.VP.veh} autoPan={false}>\n        line:{tram.VP.desi}\n        <br />\n        vehicle:{tram.VP.veh}\n        <br />\n        speed:{(tram.VP.spd * 3.6).toFixed(2)} km/h\n        <br />\n        stop:{tram.VP.stop}\n        <br />\n        route:{tram.VP.route}\n        <br />\n        {tram.VP.dl > 0 ? 'ahead ' : 'lagging '} {Math.abs(tram.VP.dl)} seconds\n        <br />\n        {tram.VP.drst === 0 ? 'doors closed' : 'doors open'}\n        <br />\n        {(!myTram.VP || (myTram.VP && myTram.VP.veh !== tram.VP.veh)) && (\n          <Button value={tram.VP.veh} onClick={handleChooseTram}>\n            CHOOSE\n          </Button>\n        )}\n      </Popup>\n    )\n  }\n\n  const ShowChosenTrams = () => {\n    let tramsToShow = [...trams].filter(tram =>\n      showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh)\n    )\n\n    if (showTrams) {\n      return tramsToShow.map((tram, i) => (\n        <Marker\n          key={i}\n          icon={\n            myTram.VP && myTram.VP.veh === tram.VP.veh ? myTramIcon : tramIcon\n          }\n          position={{\n            lat: tram.VP.lat,\n            lng: tram.VP.long,\n          }}\n          zIndex={2}\n        >\n          {popUp(tram)}\n        </Marker>\n      ))\n    }\n  }\n\n  const showStops = () => {\n    return (\n      stops &&\n      stops.map((stop, i) => (\n        <Marker\n          onClick={() => setMyStop(stop)}\n          key={i}\n          icon={stop.id === myStop.id ? myStopIcon : stopIcon}\n          position={{ lat: stop.lat, lng: stop.lon }}\n          zIndex={1}\n        >\n          <Popup autoPan={false}>\n            <br /> {stop.name}\n            <br /> {stop.gtfsId}\n          </Popup>\n        </Marker>\n      ))\n    )\n  }\n\n  const style = settings.showSidebar\n    ? { marginLeft: '20px' }\n    : { marginLeft: '0' }\n\n  return (\n    <div id='mapContainer' style={style}>\n      {settings.showSidebarOpenButton && (\n        <Button\n          id='sidebarButton'\n          variant='light'\n          style={{ display: settings.showSidebar ? 'none' : '' }}\n          onClick={() => openSidebar()}\n        >\n          {settings.showSidebarOpenButton ? '☰' : ''}\n        </Button>\n      )}\n      {myTram && <div id='distanceOnMap'>{settings.distance} m</div>}\n      {myTram && <div id='durationOnMap'>{settings.avgDuration > 0 && printDuration(settings.avgDuration)}</div>}\n      {myTram && <div id='alarmButtonOnMap'><img src={settings.alarm ? alarmOffButton : alarmOnButton} onClick={() => setAlarm(!settings.alarm)} /></div>}\n      {!settings.showAlert && (\n        <Map\n          id='map'\n          center={settings.center}\n          zoom={settings.zoom}\n          onclick={() => closeSidebar()}\n          zoomControl={false}\n        >\n          <TileLayer\n            url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n            attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n          />\n          {ShowChosenTrams()}\n          {showStops()}\n          <Marker\n            icon={driverIcon}\n            position={{ lat: 60.170627, lng: 24.939946 }}\n          >\n            <Popup>\n              We are here! <br /> This is our position!\n            </Popup>\n          </Marker>\n        </Map>\n      )}\n\n      <Alert\n        id='alert'\n        show={settings.showAlert}\n        variant={settings.alertVariant ? 'danger' : 'warning'}\n      >\n        <br />\n        <br />\n        <br />\n        <br />\n        <br />\n        <Alert.Heading>How's it going?!</Alert.Heading>\n        <p>Duis mollis, est non commodo luctus</p>\n        <hr />\n        <div className='d-flex justify-content-end'>\n          <Button onClick={() => setShowAlert(false)} variant='warning'>\n            Close me ya'll!\n          </Button>\n        </div>\n      </Alert>\n    </div>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    trams: state.trams,\n    showTrams: state.showTrams,\n    //showSidebar: state.showSidebar,\n    showSidebarOpenButton: state.showSidebarOpenButton,\n    stops: state.stops,\n    settings: state.settings,\n    myStop: state.myStop,\n    myTram: state.myTram,\n  }\n}\n\nconst mapDispatchToProps = {\n  setShowTrams,\n  setMyStop,\n  setMyTram,\n  setZoom,\n  setCenter,\n  setShowAlert,\n  openSidebar,\n  closeSidebar,\n  setLine,\n  setAlarm,\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LeafletMap)\n"]},"metadata":{},"sourceType":"module"}