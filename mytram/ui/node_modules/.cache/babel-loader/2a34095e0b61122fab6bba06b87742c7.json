{"ast":null,"code":"import _slicedToArray from \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/App.js\";\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n      {\\n        stopsByRadius(lat: 60.170627, lon: 24.939946, radius: 200) {\\n          edges {\\n            node {\\n              stop {\\n                id\\n                gtfsId\\n                 name\\n                lat\\n                lon \\n              }\\n            }\\n          }\\n        }\\n      }\\n      \"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { setTrams } from './reducers/tramsReducer';\nimport { setShowSidebar } from './reducers/showSidebarReducer';\nimport { setShowSidebarOpenButton } from './reducers/showSidebarOpenButtonReducer';\nimport { setStops } from './reducers/stopsReducer';\nimport { setMyStop } from './reducers/myStopReducer';\nimport './App.css';\nimport LeafletMap from './components/LeafletMap';\nimport Sidebar from './components/Sidebar';\nimport ApolloClient, { gql } from 'apollo-boost';\nconst client = new ApolloClient({\n  uri: 'https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql'\n});\nconst query = gql(_templateObject());\n\nconst App = ({\n  setTrams,\n  setShowSidebar,\n  setShowSidebarOpenButton,\n  stops,\n  setStops,\n  myStop,\n  setMyStop\n}) => {\n  console.log('rendering App!!!!!');\n\n  const _useState = useState({\n    lat: 60.170627,\n    lng: 24.939946\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        center = _useState2[0],\n        setCenter = _useState2[1];\n\n  const _useState3 = useState(16),\n        _useState4 = _slicedToArray(_useState3, 2),\n        zoom = _useState4[0],\n        setZoom = _useState4[1]; //const [stops, setStops] = useState([])\n  //const [myStop, setMyStop] = useState({})\n\n\n  useEffect(() => {\n    client.query({\n      query\n    }).then(response => {\n      let edges = response.data.stopsByRadius.edges;\n      setStops(edges);\n      setMyStop(edges[0]);\n      console.log('EDGES: ', edges);\n      console.log('EDGES[0]: ', edges[0].node.stop.name, edges[0].node.stop.gtfsId);\n      edges.forEach(edge => {\n        console.log('HSL: ', edge.node.stop);\n      });\n    });\n  }, []);\n\n  const update = () => {\n    //fetch('http://localhost:3001/trams')\n    //console.log('STOPS: ', stops)\n    console.log('MY STOP:', myStop);\n\n    if (myStop === {}) {\n      console.log('PÖÖ: ');\n    }\n    /*  if(myStop != {}){\n         setCenter({lat:myStop.node.stop.lat, lng:myStop.node.stop.lon}) \n      console.log()\n     } */\n\n\n    fetch('/trams').then(response => response.json()).then(body => {\n      setTrams(body);\n    }).catch(error => {\n      console.log(error);\n    });\n  }; //useEffect(() => update(), [new Date()])\n\n\n  setInterval(() => {\n    update();\n  }, 1000);\n\n  const openSidebar = () => {\n    setShowSidebar(true);\n    setShowSidebarOpenButton(false);\n    console.log('open!');\n  };\n\n  const closeSidebar = () => {\n    setShowSidebar(false);\n    setTimeout(() => {\n      setShowSidebarOpenButton(true);\n    }, 300);\n    console.log('close!');\n  };\n\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(Sidebar, {\n    closeSidebar: closeSidebar,\n    setCenter: setCenter,\n    setZoom: setZoom //stops={stops}\n    //myStop={myStop}\n    //setMyStop={setMyStop}\n    ,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }), React.createElement(LeafletMap, {\n    openSidebar: openSidebar,\n    closeSidebar: closeSidebar,\n    center: center,\n    zoom: zoom //stops={stops}\n    ,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }));\n};\n\nconst mapStateToProps = state => {\n  return {\n    stops: state.stops,\n    myStop: state.myStop\n  };\n};\n\nconst mapDispatchToProps = {\n  setTrams,\n  setShowSidebar,\n  setShowSidebarOpenButton,\n  setStops,\n  setMyStop\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(App); ////////// GEOLOCATION\n\n/*   if (\"geolocation\" in navigator) {\n    console.log(\"geolocation is available\");\n  } else {\n    console.log(\"geolocation is NOT available\");\n  }\n  navigator.geolocation.getCurrentPosition(position => { \n\n    const query = gql`\n      {\n        stopsByRadius(lat: ${position.coords.latitude}, lon: ${position.coords.longitude}, radius: 1000) {\n          edges {\n            node {\n              stop {\n                id\n                gtfsId\n                 name\n                lat\n                lon \n              }\n            }\n          }\n        }\n      }\n      ` \n    client.query({ query })\n      .then((response) => {\n        let edges = response.data.stopsByRadius.edges\n        setStops(edges)\n        edges.forEach(edge => {\n          console.log('HSL: ', edge.node.stop)\n        })\n      })\n    console.log(\"STARTING LOCATION \\nlatitude: \" + position.coords.latitude + \" longitude: \" + position.coords.longitude);\n  }); */","map":{"version":3,"sources":["/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/App.js"],"names":["React","useState","useEffect","connect","setTrams","setShowSidebar","setShowSidebarOpenButton","setStops","setMyStop","LeafletMap","Sidebar","ApolloClient","gql","client","uri","query","App","stops","myStop","console","log","lat","lng","center","setCenter","zoom","setZoom","then","response","edges","data","stopsByRadius","node","stop","name","gtfsId","forEach","edge","update","fetch","json","body","catch","error","setInterval","openSidebar","closeSidebar","setTimeout","mapStateToProps","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { setTrams } from './reducers/tramsReducer'\nimport { setShowSidebar } from './reducers/showSidebarReducer'\nimport { setShowSidebarOpenButton } from './reducers/showSidebarOpenButtonReducer'\nimport { setStops } from './reducers/stopsReducer'\nimport { setMyStop } from './reducers/myStopReducer'\nimport './App.css'\nimport LeafletMap from './components/LeafletMap'\nimport Sidebar from './components/Sidebar'\nimport ApolloClient, { gql } from 'apollo-boost'\n\nconst client = new ApolloClient({\n  uri: 'https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql'\n})\n\nconst query = gql`\n      {\n        stopsByRadius(lat: 60.170627, lon: 24.939946, radius: 200) {\n          edges {\n            node {\n              stop {\n                id\n                gtfsId\n                 name\n                lat\n                lon \n              }\n            }\n          }\n        }\n      }\n      `\n\n\n\nconst App = ({\n  setTrams,\n  setShowSidebar,\n  setShowSidebarOpenButton,\n  stops,\n  setStops,\n  myStop,\n  setMyStop\n}) => {\n\n  console.log('rendering App!!!!!')\n  const [center, setCenter] = useState({ lat: 60.170627, lng: 24.939946 })\n  const [zoom, setZoom] = useState(16)\n  //const [stops, setStops] = useState([])\n  //const [myStop, setMyStop] = useState({})\n\n  useEffect(() => {\n    \n    client.query({ query })\n      .then((response) => {\n        let edges = response.data.stopsByRadius.edges\n        setStops(edges)\n        setMyStop(edges[0])\n        console.log('EDGES: ', edges)\n        console.log('EDGES[0]: ',edges[0].node.stop.name, edges[0].node.stop.gtfsId)\n        edges.forEach(edge => {\n          console.log('HSL: ', edge.node.stop)\n        })\n      })\n  }, [])\n\n\n\n\n\n  const update = () => {\n    //fetch('http://localhost:3001/trams')\n    //console.log('STOPS: ', stops)\n    console.log('MY STOP:', myStop)\n    if (myStop === {}) {\n      console.log('PÖÖ: ')\n     }\n   /*  if(myStop != {}){\n        setCenter({lat:myStop.node.stop.lat, lng:myStop.node.stop.lon}) \n     console.log()\n    } */\n    fetch('/trams')\n      .then(response => response.json())\n      .then(body => {\n        setTrams(body)\n      })\n      .catch(error => {\n        console.log(error)\n      })\n  }\n\n  //useEffect(() => update(), [new Date()])\n  setInterval(() => {\n    update()\n  }, 1000)\n\n  const openSidebar = () => {\n    setShowSidebar(true)\n    setShowSidebarOpenButton(false)\n    console.log('open!')\n  }\n\n  const closeSidebar = () => {\n    setShowSidebar(false)\n    setTimeout(() => {\n      setShowSidebarOpenButton(true)\n    }, 300)\n    console.log('close!')\n  }\n\n  return (\n    <div className='App'>\n      <Sidebar\n        closeSidebar={closeSidebar}\n        setCenter={setCenter}\n        setZoom={setZoom}\n      //stops={stops}\n      //myStop={myStop}\n      //setMyStop={setMyStop}\n      />\n      <LeafletMap\n        openSidebar={openSidebar}\n        closeSidebar={closeSidebar}\n        center={center}\n        zoom={zoom}\n      //stops={stops}\n      />\n    </div>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    stops: state.stops,\n    myStop: state.myStop,\n  }\n}\n\nconst mapDispatchToProps = {\n  setTrams, setShowSidebar, setShowSidebarOpenButton, setStops, setMyStop\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App)\n\n\n////////// GEOLOCATION\n\n  /*   if (\"geolocation\" in navigator) {\n      console.log(\"geolocation is available\");\n    } else {\n      console.log(\"geolocation is NOT available\");\n    }\n    navigator.geolocation.getCurrentPosition(position => { \n  \n      const query = gql`\n        {\n          stopsByRadius(lat: ${position.coords.latitude}, lon: ${position.coords.longitude}, radius: 1000) {\n            edges {\n              node {\n                stop {\n                  id\n                  gtfsId\n                   name\n                  lat\n                  lon \n                }\n              }\n            }\n          }\n        }\n        ` \n      client.query({ query })\n        .then((response) => {\n          let edges = response.data.stopsByRadius.edges\n          setStops(edges)\n          edges.forEach(edge => {\n            console.log('HSL: ', edge.node.stop)\n          })\n        })\n      console.log(\"STARTING LOCATION \\nlatitude: \" + position.coords.latitude + \" longitude: \" + position.coords.longitude);\n    }); */\n\n\n"]},"metadata":{},"sourceType":"module"}