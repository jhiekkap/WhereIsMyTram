{"ast":null,"code":"var _jsxFileName = \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/App.js\";\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { setTrams } from './reducers/tramsReducer';\nimport { setInit } from './reducers/settingsReducer';\nimport { setStops } from './reducers/stopsReducer';\nimport { setMyStop } from './reducers/myStopReducer';\nimport { setShowTrams } from './reducers/showTramsReducer';\nimport './App.css';\nimport LeafletMap from './components/LeafletMap';\nimport Sidebar from './components/Sidebar';\nimport client, { query } from './utils/client';\n\nconst App = ({\n  setTrams,\n  setShowTrams,\n  setStops,\n  setMyStop,\n  settings,\n  setInit\n}) => {\n  useEffect(() => {\n    client.query({\n      query\n    }).then(response => {\n      console.log('GRAPHQL - QUERY!');\n      let allStops = response.data.stopsByRadius.edges.map(edge => edge.node.stop).filter(stop => stop.vehicleType === 0);\n      setStops(allStops);\n      setMyStop(allStops[0]);\n    });\n  }, []);\n\n  const update = () => {\n    fetch('/trams').then(response => response.json()).then(body => {\n      setTrams(body);\n\n      if (settings.init) {\n        console.log('INIT: ', settings.init, new Date());\n        setShowTrams(body);\n      }\n    }).catch(error => {\n      console.log(error);\n    });\n  };\n\n  useState(() => {\n    const timer = setInterval(() => {\n      update();\n    }, 1000);\n  }, []);\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }, React.createElement(Sidebar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }), React.createElement(LeafletMap, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }));\n};\n\nconst mapStateToProps = state => {\n  return {\n    settings: state.settings\n  };\n};\n\nconst mapDispatchToProps = {\n  setTrams,\n  setStops,\n  setMyStop,\n  setShowTrams,\n  setInit\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(App); ////////// GEOLOCATION\n\n/*   if (\"geolocation\" in navigator) {\n      console.log(\"geolocation is available\");\n    } else {\n      console.log(\"geolocation is NOT available\");\n    }\n    navigator.geolocation.getCurrentPosition(position => { \n  \n      const query = gql`\n        {\n          stopsByRadius(lat: ${position.coords.latitude}, lon: ${position.coords.longitude}, radius: 1000) {\n            edges {\n              node {\n                stop {\n                  id\n                  gtfsId\n                   name\n                  lat\n                  lon \n                }\n              }\n            }\n          }\n        }\n        ` \n      client.query({ query })\n        .then((response) => {\n          let edges = response.data.stopsByRadius.edges\n          setStops(edges)\n          edges.forEach(edge => {\n            console.log('HSL: ', edge.node.stop)\n          })\n        })\n      console.log(\"STARTING LOCATION \\nlatitude: \" + position.coords.latitude + \" longitude: \" + position.coords.longitude);\n    }); */","map":{"version":3,"sources":["/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/App.js"],"names":["React","useEffect","useState","connect","setTrams","setInit","setStops","setMyStop","setShowTrams","LeafletMap","Sidebar","client","query","App","settings","then","response","console","log","allStops","data","stopsByRadius","edges","map","edge","node","stop","filter","vehicleType","update","fetch","json","body","init","Date","catch","error","timer","setInterval","mapStateToProps","state","mapDispatchToProps"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,SAASC,OAAT,QAAwB,4BAAxB;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,SAASC,SAAT,QAA0B,0BAA1B;AACA,SAASC,YAAT,QAA6B,6BAA7B;AACA,OAAO,WAAP;AACA,OAAOC,UAAP,MAAuB,yBAAvB;AACA,OAAOC,OAAP,MAAoB,sBAApB;AACA,OAAOC,MAAP,IAAiBC,KAAjB,QAA8B,gBAA9B;;AAEA,MAAMC,GAAG,GAAG,CAAC;AACXT,EAAAA,QADW;AAEXI,EAAAA,YAFW;AAGXF,EAAAA,QAHW;AAIXC,EAAAA,SAJW;AAKXO,EAAAA,QALW;AAMXT,EAAAA;AANW,CAAD,KAON;AACJJ,EAAAA,SAAS,CAAC,MAAM;AACdU,IAAAA,MAAM,CAACC,KAAP,CAAa;AAAEA,MAAAA;AAAF,KAAb,EAAwBG,IAAxB,CAA6BC,QAAQ,IAAI;AACvCC,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACA,UAAIC,QAAQ,GAAGH,QAAQ,CAACI,IAAT,CAAcC,aAAd,CAA4BC,KAA5B,CACZC,GADY,CACRC,IAAI,IAAIA,IAAI,CAACC,IAAL,CAAUC,IADV,EAEZC,MAFY,CAELD,IAAI,IAAIA,IAAI,CAACE,WAAL,KAAqB,CAFxB,CAAf;AAGAtB,MAAAA,QAAQ,CAACa,QAAD,CAAR;AACAZ,MAAAA,SAAS,CAACY,QAAQ,CAAC,CAAD,CAAT,CAAT;AACD,KAPD;AAQD,GATQ,EASN,EATM,CAAT;;AAWA,QAAMU,MAAM,GAAG,MAAM;AACnBC,IAAAA,KAAK,CAAC,QAAD,CAAL,CACGf,IADH,CACQC,QAAQ,IAAIA,QAAQ,CAACe,IAAT,EADpB,EAEGhB,IAFH,CAEQiB,IAAI,IAAI;AACZ5B,MAAAA,QAAQ,CAAC4B,IAAD,CAAR;;AACA,UAAIlB,QAAQ,CAACmB,IAAb,EAAmB;AACjBhB,QAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBJ,QAAQ,CAACmB,IAA/B,EAAqC,IAAIC,IAAJ,EAArC;AACA1B,QAAAA,YAAY,CAACwB,IAAD,CAAZ;AACD;AACF,KARH,EASGG,KATH,CASSC,KAAK,IAAI;AACdnB,MAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACD,KAXH;AAYD,GAbD;;AAeAlC,EAAAA,QAAQ,CAAC,MAAM;AACb,UAAMmC,KAAK,GAAGC,WAAW,CAAC,MAAM;AAC9BT,MAAAA,MAAM;AACP,KAFwB,EAEtB,IAFsB,CAAzB;AAGD,GAJO,EAIL,EAJK,CAAR;AAMA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF;AAMD,CA9CD;;AAgDA,MAAMU,eAAe,GAAGC,KAAK,IAAI;AAC/B,SAAO;AACL1B,IAAAA,QAAQ,EAAE0B,KAAK,CAAC1B;AADX,GAAP;AAGD,CAJD;;AAMA,MAAM2B,kBAAkB,GAAG;AACzBrC,EAAAA,QADyB;AAEzBE,EAAAA,QAFyB;AAGzBC,EAAAA,SAHyB;AAIzBC,EAAAA,YAJyB;AAKzBH,EAAAA;AALyB,CAA3B;AAQA,eAAeF,OAAO,CACpBoC,eADoB,EAEpBE,kBAFoB,CAAP,CAGb5B,GAHa,CAAf,C,CAKA;;AAEA","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux'\nimport { setTrams } from './reducers/tramsReducer'\nimport { setInit } from './reducers/settingsReducer'\nimport { setStops } from './reducers/stopsReducer'\nimport { setMyStop } from './reducers/myStopReducer'\nimport { setShowTrams } from './reducers/showTramsReducer'\nimport './App.css'\nimport LeafletMap from './components/LeafletMap'\nimport Sidebar from './components/Sidebar'\nimport client, { query } from './utils/client'\n\nconst App = ({\n  setTrams,\n  setShowTrams,\n  setStops,\n  setMyStop,\n  settings,\n  setInit,\n}) => {\n  useEffect(() => {\n    client.query({ query }).then(response => {\n      console.log('GRAPHQL - QUERY!') \n      let allStops = response.data.stopsByRadius.edges\n        .map(edge => edge.node.stop)\n        .filter(stop => stop.vehicleType === 0)\n      setStops(allStops)\n      setMyStop(allStops[0])\n    })\n  }, [])\n\n  const update = () => {\n    fetch('/trams')\n      .then(response => response.json())\n      .then(body => {\n        setTrams(body)\n        if (settings.init) {\n          console.log('INIT: ', settings.init, new Date())\n          setShowTrams(body)\n        } \n      })\n      .catch(error => {\n        console.log(error)\n      })\n  }\n\n  useState(() => {\n    const timer = setInterval(() => {\n      update()  \n    }, 1000)\n  }, [])\n\n  return (\n    <div>\n      <Sidebar />\n      <LeafletMap />\n    </div>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    settings: state.settings,\n  }\n}\n\nconst mapDispatchToProps = {\n  setTrams,\n  setStops,\n  setMyStop,\n  setShowTrams,\n  setInit,\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App)\n\n////////// GEOLOCATION\n\n/*   if (\"geolocation\" in navigator) {\n      console.log(\"geolocation is available\");\n    } else {\n      console.log(\"geolocation is NOT available\");\n    }\n    navigator.geolocation.getCurrentPosition(position => { \n  \n      const query = gql`\n        {\n          stopsByRadius(lat: ${position.coords.latitude}, lon: ${position.coords.longitude}, radius: 1000) {\n            edges {\n              node {\n                stop {\n                  id\n                  gtfsId\n                   name\n                  lat\n                  lon \n                }\n              }\n            }\n          }\n        }\n        ` \n      client.query({ query })\n        .then((response) => {\n          let edges = response.data.stopsByRadius.edges\n          setStops(edges)\n          edges.forEach(edge => {\n            console.log('HSL: ', edge.node.stop)\n          })\n        })\n      console.log(\"STARTING LOCATION \\nlatitude: \" + position.coords.latitude + \" longitude: \" + position.coords.longitude);\n    }); */\n"]},"metadata":{},"sourceType":"module"}