{"ast":null,"code":"var _jsxFileName = \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/components/LeafletMap.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { setShowTrams } from '../reducers/showTramsReducer';\nimport { setMyTram } from '../reducers/myTramReducer';\nimport { setCenter, setZoom, setShowAlert, openSidebar, closeSidebar, toggleAlertVariant } from '../reducers/settingsReducer';\nimport { setMyStop } from '../reducers/myStopReducer';\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet';\nimport { Button, Alert } from 'react-bootstrap';\nimport driverIcon, { stopIcon, myStopIcon, myTramIcon, locationIcon } from '../utils/icons';\n\nconst LeafletMap = ({\n  trams,\n  showTrams,\n  setShowTrams,\n  openSidebar,\n  closeSidebar,\n  setCenter,\n  setZoom,\n  stops,\n  myStop,\n  setMyStop,\n  myTram,\n  setMyTram,\n  settings,\n  setShowAlert\n}) => {\n  const handleChooseTram = e => {\n    console.log('valitse nro: ', e.target.value);\n    let chosenTram = trams.find(tram => tram.VP.veh == e.target.value);\n    setMyTram(chosenTram);\n    setShowTrams([]); //setCenter({ lat: chosenTram.VP.lat, lng: chosenTram.VP.long })\n    //setZoom(16)\n  };\n\n  const popUp = tram => {\n    return React.createElement(Popup, {\n      closeButton: true,\n      value: tram.VP.veh,\n      autoPan: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, \"line:\", tram.VP.desi, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46\n      },\n      __self: this\n    }), \"vehicle:\", tram.VP.veh, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }), \"speed:\", (tram.VP.spd * 3.6).toFixed(2), \" km/h\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }), \"stop:\", tram.VP.stop, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }), \"route:\", tram.VP.route, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }), tram.VP.dl > 0 ? 'ahead ' : 'lagging ', \" \", Math.abs(tram.VP.dl), \" seconds\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }), tram.VP.drst === 0 ? 'doors closed' : 'doors open', React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }), (!myTram.VP || myTram.VP && myTram.VP.veh !== tram.VP.veh) && React.createElement(Button, {\n      value: tram.VP.veh,\n      onClick: handleChooseTram,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, \"CHOOSE\"));\n  };\n\n  const ShowChosenTrams = () => {\n    let tramsToShow = [...trams].filter(tram => showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh));\n\n    if (myTram.VP) {\n      tramsToShow = tramsToShow.filter(tram => tram.VP.veh !== myTram.VP.veh);\n    }\n\n    if (showTrams) {\n      return tramsToShow.map((tram, i) => React.createElement(Marker, {\n        key: i,\n        position: {\n          lat: tram.VP.lat,\n          lng: tram.VP.long\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, popUp(tram)));\n    }\n  };\n\n  const showMyTram = () => {\n    if (myTram.VP) {\n      let myTramAlive = trams.find(tram => tram.VP.veh === myTram.VP.veh);\n      let halfWay = {\n        lat: (myStop.lat + myTramAlive.VP.lat) / 2,\n        lng: (myStop.lon + myTramAlive.VP.long) / 2\n      };\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(Marker, {\n        icon: myTramIcon,\n        position: {\n          lat: myTramAlive.VP.lat,\n          lng: myTramAlive.VP.long\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, popUp(myTramAlive)), React.createElement(Marker, {\n        icon: locationIcon,\n        position: halfWay,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }));\n    }\n  };\n\n  const showStops = () => {\n    return stops && stops.map((stop, i) => React.createElement(Marker, {\n      onClick: () => setMyStop(stop),\n      key: i,\n      icon: stop.id === myStop.id ? myStopIcon : stopIcon,\n      position: {\n        lat: stop.lat,\n        lng: stop.lon\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(Popup, {\n      autoPan: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }), \" \", stop.name, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }), \" \", stop.gtfsId)));\n  };\n\n  const style = settings.showSidebar ? {\n    marginLeft: '20px'\n  } : {\n    marginLeft: '0'\n  };\n  return React.createElement(\"div\", {\n    id: \"mapContainer\",\n    style: style,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, settings.showSidebarOpenButton && React.createElement(Button, {\n    variant: \"light\",\n    style: {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      zIndex: 1,\n      fontSize: 36,\n      marginTop: '4px',\n      display: settings.showSidebar ? 'none' : ''\n    },\n    onClick: () => openSidebar(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, settings.showSidebarOpenButton ? 'â˜°' : ''), !settings.showAlert && React.createElement(Map, {\n    id: \"map\",\n    center: settings.center,\n    zoom: settings.zoom,\n    onclick: () => closeSidebar(),\n    zoomControl: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, React.createElement(TileLayer, {\n    url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n    attribution: \"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }), ShowChosenTrams(), showStops(), showMyTram(), React.createElement(Marker, {\n    icon: driverIcon,\n    position: {\n      lat: 60.170627,\n      lng: 24.939946\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, React.createElement(Popup, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, \"We are here! \", React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }), \" This is our position!\"))), React.createElement(Alert, {\n    id: \"alert\",\n    show: settings.showAlert,\n    variant: settings.alertVariant ? 'danger' : 'warning',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), React.createElement(Alert.Heading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, \"How's it going?!\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, \"Duis mollis, est non commodo luctus\"), React.createElement(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"d-flex justify-content-end\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, React.createElement(Button, {\n    onClick: () => setShowAlert(false),\n    variant: \"warning\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, \"Close me ya'll!\"))));\n};\n\nconst mapStateToProps = state => {\n  return {\n    tram: state.tram,\n    showTrams: state.showTrams,\n    //showSidebar: state.showSidebar,\n    showSidebarOpenButton: state.showSidebarOpenButton,\n    stops: state.stops,\n    settings: state.settings,\n    myStop: state.myStop //myTram: state.myTram,\n\n  };\n};\n\nconst mapDispatchToProps = {\n  setShowTrams,\n  setMyStop,\n  setMyTram,\n  setZoom,\n  setCenter,\n  setShowAlert,\n  openSidebar,\n  closeSidebar\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(LeafletMap);","map":{"version":3,"sources":["/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/components/LeafletMap.js"],"names":["React","connect","setShowTrams","setMyTram","setCenter","setZoom","setShowAlert","openSidebar","closeSidebar","toggleAlertVariant","setMyStop","Map","Marker","Popup","TileLayer","Button","Alert","driverIcon","stopIcon","myStopIcon","myTramIcon","locationIcon","LeafletMap","trams","showTrams","stops","myStop","myTram","settings","handleChooseTram","e","console","log","target","value","chosenTram","find","tram","VP","veh","popUp","desi","spd","toFixed","stop","route","dl","Math","abs","drst","ShowChosenTrams","tramsToShow","filter","map","includes","i","lat","lng","long","showMyTram","myTramAlive","halfWay","lon","showStops","id","name","gtfsId","style","showSidebar","marginLeft","showSidebarOpenButton","position","top","left","zIndex","fontSize","marginTop","display","showAlert","center","zoom","alertVariant","mapStateToProps","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { connect } from 'react-redux'\nimport { setShowTrams } from '../reducers/showTramsReducer'\nimport { setMyTram } from '../reducers/myTramReducer'\nimport { setCenter, setZoom, setShowAlert, openSidebar, closeSidebar, toggleAlertVariant } from '../reducers/settingsReducer'\nimport { setMyStop } from '../reducers/myStopReducer';\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet'\nimport { Button, Alert } from 'react-bootstrap'\nimport driverIcon, { stopIcon, myStopIcon, myTramIcon, locationIcon } from '../utils/icons'\n\nconst LeafletMap = ({\n  trams,\n  showTrams,\n  setShowTrams,\n  openSidebar,\n  closeSidebar,\n  setCenter,\n  setZoom,\n  stops,\n  myStop,\n  setMyStop,\n  myTram,\n  setMyTram,\n  settings,\n  setShowAlert,\n}) => {\n\n  const handleChooseTram = e => {\n    console.log('valitse nro: ', e.target.value)\n    let chosenTram = trams.find(tram => tram.VP.veh == e.target.value)\n    setMyTram(chosenTram)\n    setShowTrams([])\n    //setCenter({ lat: chosenTram.VP.lat, lng: chosenTram.VP.long })\n    //setZoom(16)\n\n  }\n\n  const popUp = tram => {\n    return (\n      <Popup\n        closeButton={true}\n        value={tram.VP.veh}\n        autoPan={false}\n      >\n        line:{tram.VP.desi}\n        <br />\n        vehicle:{tram.VP.veh}\n        <br />\n        speed:{(tram.VP.spd * 3.6).toFixed(2)} km/h\n        <br />\n        stop:{tram.VP.stop}\n        <br />\n        route:{tram.VP.route}\n        <br />\n        {tram.VP.dl > 0 ? 'ahead ' : 'lagging '} {Math.abs(tram.VP.dl)} seconds\n        <br />\n        {tram.VP.drst === 0 ? 'doors closed' : 'doors open'}\n        <br />\n        {(!myTram.VP || (myTram.VP && myTram.VP.veh !== tram.VP.veh)) && <Button value={tram.VP.veh} onClick={handleChooseTram}>CHOOSE</Button>}\n      </Popup>\n    )\n  }\n\n  const ShowChosenTrams = () => {\n\n    let tramsToShow = [...trams].filter(tram =>\n      showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh)\n    )\n    if (myTram.VP) {\n      tramsToShow = tramsToShow.filter(tram => tram.VP.veh !== myTram.VP.veh)\n    }\n\n    if (showTrams) {\n      return tramsToShow.map((tram, i) => (\n        <Marker\n          key={i}\n          position={{\n            lat: tram.VP.lat,\n            lng: tram.VP.long,\n          }}\n        >\n          {popUp(tram)}\n        </Marker>\n      ))\n    }\n  }\n\n  const showMyTram = () => {\n    if (myTram.VP) {\n      let myTramAlive = trams.find(tram => tram.VP.veh === myTram.VP.veh)\n      let halfWay = { lat: (myStop.lat +  myTramAlive.VP.lat)/2,\n        lng: (myStop.lon + myTramAlive.VP.long)/2 }\n      return (\n        <div>\n        <Marker\n          icon={myTramIcon}\n          position={{ lat: myTramAlive.VP.lat, lng: myTramAlive.VP.long }}\n        >\n          {popUp(myTramAlive)}\n        </Marker>\n        <Marker\n        icon={locationIcon}\n        position={halfWay}\n      >\n        \n      </Marker>\n      </div>\n      )\n    }\n  }\n\n  const showStops = () => {\n\n    return stops &&\n      stops.map((stop, i) => (\n        <Marker\n          onClick={() => setMyStop(stop)}\n          key={i}\n          icon={stop.id === myStop.id ? myStopIcon : stopIcon}\n          position={{ lat: stop.lat, lng: stop.lon }}\n        >\n          <Popup autoPan={false}>\n            <br /> {stop.name}\n            <br /> {stop.gtfsId}\n          </Popup>\n        </Marker>\n      ))\n  }\n\n  const style = settings.showSidebar ? { marginLeft: '20px' } : { marginLeft: '0' }\n\n  return (\n    <div\n      id='mapContainer'\n      style={style} >\n      {settings.showSidebarOpenButton && (\n        <Button\n          variant='light'\n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            zIndex: 1,\n            fontSize: 36,\n            marginTop: '4px',\n            display: settings.showSidebar ? 'none' : '',\n          }}\n          onClick={() => openSidebar()}\n        >\n          {settings.showSidebarOpenButton ? 'â˜°' : ''}\n        </Button>\n      )}\n        {!settings.showAlert && <Map\n        id='map'\n        center={settings.center}\n        zoom={settings.zoom}\n        onclick={() => closeSidebar()}\n        zoomControl={false}\n      >\n        <TileLayer\n          url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n          attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        />\n        {ShowChosenTrams()}\n        {showStops()}\n        {showMyTram()}\n        <Marker\n          icon={driverIcon}\n          position={{ lat: 60.170627, lng: 24.939946 }}\n        >\n          <Popup>\n            We are here! <br /> This is our position!\n          </Popup>\n        </Marker>\n      </Map>}  \n      <Alert id='alert' show={settings.showAlert} variant={settings.alertVariant ? 'danger' : 'warning'}>\n        <br /><br /><br /><br /><br />\n        <Alert.Heading>How's it going?!</Alert.Heading>\n        <p>\n          Duis mollis, est non commodo luctus \n        </p>\n        <hr />\n        <div className='d-flex justify-content-end'>\n          <Button onClick={() => setShowAlert(false)} variant='warning'>\n            Close me ya'll!\n          </Button>\n        </div>\n      </Alert>\n    </div>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    tram: state.tram,\n    showTrams: state.showTrams,\n    //showSidebar: state.showSidebar,\n    showSidebarOpenButton: state.showSidebarOpenButton,\n    stops: state.stops,\n    settings: state.settings,\n    myStop: state.myStop,\n    //myTram: state.myTram,\n  }\n}\n\nconst mapDispatchToProps = {\n  setShowTrams,\n  setMyStop, setMyTram, setZoom, setCenter, setShowAlert, openSidebar, closeSidebar,\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LeafletMap)\n"]},"metadata":{},"sourceType":"module"}