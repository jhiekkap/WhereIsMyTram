{"ast":null,"code":"var _jsxFileName = \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/components/LeafletMap.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { setShowTrams } from '../reducers/showTramsReducer';\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet';\nimport { Button } from 'react-bootstrap';\nimport L from 'leaflet';\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('../img/icons8-office-xs-50.png'),\n  iconUrl: require('../img/icons8-office-xs-50.png'),\n  shadowUrl: require('../../node_modules/leaflet/dist/images/marker-shadow.png'),\n  iconSize: [40, 40]\n});\nconst pointerIcon = new L.Icon({\n  iconUrl: require('../img/iconLocation.png'),\n  iconRetinaUrl: require('../img/iconLocation.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92]\n});\nconst stopIcon = new L.Icon({\n  iconUrl: require('../img/redPin.png'),\n  iconRetinaUrl: require('../img/redPin.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92]\n});\nconst myStopIcon = new L.Icon({\n  iconUrl: require('../img/rosaPin.png'),\n  iconRetinaUrl: require('../img/rosaPin.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92]\n});\nconst myTramIcon = new L.Icon({\n  iconUrl: require('../img/icons8-color-50.png'),\n  iconRetinaUrl: require('../img/icons8-color-50.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92]\n});\n\nconst LeafletMap = ({\n  trams,\n  showTrams,\n  setShowTrams,\n  openSidebar,\n  closeSidebar,\n  showSidebar,\n  showSidebarOpenButton,\n  center,\n  zoom,\n  stops,\n  myStop,\n  myTram\n}) => {\n  const handleHideTram = veh => {\n    console.log('piilota ratikka nro: ', veh);\n    setShowTrams(showTrams.filter(tram => tram.VP.veh !== veh));\n  };\n\n  const popUp = tram => {\n    return React.createElement(Popup, {\n      closeButton: false,\n      value: tram.VP.veh,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, \"line:\", tram.VP.desi, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }), \"vehicle:\", tram.VP.veh, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), \"speed:\", (tram.VP.spd * 3.6).toFixed(2), \" km/h\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }), \"stop:\", tram.VP.stop, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }), \"route:\", tram.VP.route, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }), tram.VP.dl > 0 ? 'ahead ' : 'lagging ', \" \", Math.abs(tram.VP.dl), \" seconds\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }), tram.VP.drst === 0 ? 'doors closed' : 'doors open', React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      onClick: () => handleHideTram(tram.VP.veh),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, \"hide x\"));\n  };\n\n  const ShowChosenTrams = () => {\n    let tramsToShow = [...trams].filter(tram => showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh));\n\n    if (myTram) {\n      tramsToShow = trams;\n    }\n\n    if (showTrams) {\n      return trams.filter(tram => showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh)).map((tram, i) => React.createElement(Marker, {\n        key: i,\n        position: {\n          lat: tram.VP.lat,\n          lng: tram.VP.long\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, popUp(tram)));\n    }\n  };\n\n  const showMyTram = () => {\n    if (myTram.VP) {\n      let myTramAlive = trams.find(tram => tram.VP.veh === myTram.VP.veh);\n      return React.createElement(Marker, {\n        icon: myTramIcon,\n        position: {\n          lat: myTramAlive.VP.lat,\n          lng: myTramAlive.VP.long\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, popUp(myTramAlive));\n    }\n  };\n\n  const style = showSidebar ? {\n    marginLeft: '20px'\n  } : {\n    marginLeft: '0'\n  };\n  return React.createElement(\"div\", {\n    id: \"map\",\n    style: style,\n    title: \"Double-click map to set a new center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, showSidebarOpenButton && React.createElement(Button, {\n    variant: \"light\",\n    style: {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      zIndex: 1,\n      fontSize: 36,\n      marginTop: '4px',\n      display: showSidebar ? 'none' : ''\n    },\n    onClick: () => openSidebar(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, showSidebarOpenButton ? 'â˜°' : ''), React.createElement(Map, {\n    id: \"map\",\n    center: center,\n    zoom: zoom,\n    onclick: () => closeSidebar(),\n    zoomControl: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, React.createElement(TileLayer, {\n    url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n    attribution: \"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }), ShowChosenTrams(), stops && stops.map((stop, i) => React.createElement(Marker, {\n    key: i,\n    icon: stop.id === myStop.id ? myStopIcon : stopIcon,\n    position: {\n      lat: stop.lat,\n      lng: stop.lon\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, React.createElement(Popup, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, \"stop \", i, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }), \" \", stop.name, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }), \" \", stop.gtfsId, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  })))), showMyTram(), React.createElement(Marker, {\n    icon: pointerIcon,\n    position: {\n      lat: 60.170627,\n      lng: 24.939946\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, React.createElement(Popup, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, \"We are here! \", React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }), \" This is our position!\"))));\n};\n\nconst mapStateToProps = state => {\n  return {\n    trams: state.trams,\n    showTrams: state.showTrams,\n    showSidebar: state.showSidebar,\n    showSidebarOpenButton: state.showSidebarOpenButton,\n    stops: state.stops,\n    center: state.center,\n    zoom: state.zoom,\n    myStop: state.myStop,\n    myTram: state.myTram\n  };\n};\n\nconst mapDispatchToProps = {\n  setShowTrams\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(LeafletMap);","map":{"version":3,"sources":["/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/components/LeafletMap.js"],"names":["React","connect","setShowTrams","Map","Marker","Popup","TileLayer","Button","L","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","iconSize","pointerIcon","iconAnchor","popupAnchor","shadowSize","shadowAnchor","stopIcon","myStopIcon","myTramIcon","LeafletMap","trams","showTrams","openSidebar","closeSidebar","showSidebar","showSidebarOpenButton","center","zoom","stops","myStop","myTram","handleHideTram","veh","console","log","filter","tram","VP","popUp","desi","spd","toFixed","stop","route","dl","Math","abs","drst","ShowChosenTrams","tramsToShow","map","includes","i","lat","lng","long","showMyTram","myTramAlive","find","style","marginLeft","position","top","left","zIndex","fontSize","marginTop","display","id","lon","name","gtfsId","mapStateToProps","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { connect } from 'react-redux'\nimport { setShowTrams } from '../reducers/showTramsReducer'\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet'\nimport { Button } from 'react-bootstrap'\nimport L from 'leaflet'\n\ndelete L.Icon.Default.prototype._getIconUrl\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('../img/icons8-office-xs-50.png'),\n  iconUrl: require('../img/icons8-office-xs-50.png'),\n  shadowUrl: require('../../node_modules/leaflet/dist/images/marker-shadow.png'),\n  iconSize: [40, 40],\n})\n\nconst pointerIcon = new L.Icon({\n  iconUrl: require('../img/iconLocation.png'),\n  iconRetinaUrl: require('../img/iconLocation.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92],\n})\n\nconst stopIcon = new L.Icon({\n  iconUrl: require('../img/redPin.png'),\n  iconRetinaUrl: require('../img/redPin.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92],\n})\n\nconst myStopIcon = new L.Icon({\n  iconUrl: require('../img/rosaPin.png'),\n  iconRetinaUrl: require('../img/rosaPin.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92],\n})\n\nconst myTramIcon = new L.Icon({\n  iconUrl: require('../img/icons8-color-50.png'),\n  iconRetinaUrl: require('../img/icons8-color-50.png'),\n  iconAnchor: [5, 55],\n  popupAnchor: [10, -44],\n  iconSize: [55, 55],\n  shadowSize: [68, 95],\n  shadowAnchor: [20, 92],\n})\n\n\n\nconst LeafletMap = ({\n  trams,\n  showTrams,\n  setShowTrams,\n  openSidebar,\n  closeSidebar,\n  showSidebar,\n  showSidebarOpenButton,\n  center,\n  zoom,\n  stops,\n  myStop,\n  myTram,\n}) => {\n  const handleHideTram = veh => {\n    console.log('piilota ratikka nro: ', veh)\n    setShowTrams(showTrams.filter(tram => tram.VP.veh !== veh))\n  }\n\n  const popUp = tram => {\n    return (\n      <Popup closeButton={false} value={tram.VP.veh}>\n        line:{tram.VP.desi}\n        <br />\n        vehicle:{tram.VP.veh}\n        <br />\n        speed:{(tram.VP.spd * 3.6).toFixed(2)} km/h\n        <br />\n        stop:{tram.VP.stop}\n        <br />\n        route:{tram.VP.route}\n        <br />\n        {tram.VP.dl > 0 ? 'ahead ' : 'lagging '} {Math.abs(tram.VP.dl)} seconds\n        <br />\n        {tram.VP.drst === 0 ? 'doors closed' : 'doors open'}\n        <br />\n        <span onClick={() => handleHideTram(tram.VP.veh)}>hide x</span>\n      </Popup>\n    )\n  }\n\n  const ShowChosenTrams = () => {\n\n    let tramsToShow = [...trams].filter(tram =>\n      showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh) \n    )\n    if(myTram){\n      tramsToShow = trams\n    }\n    if (showTrams) {\n      return trams\n        .filter(tram =>\n          showTrams.map(tram => tram.VP.veh).includes(tram.VP.veh) \n        )\n        .map((tram, i) => (\n          <Marker\n            key={i}\n            position={{\n              lat: tram.VP.lat,\n              lng: tram.VP.long,\n            }}\n          >\n            {popUp(tram)}\n          </Marker>\n        ))\n    }\n  }\n\n  const showMyTram = () => {\n    if (myTram.VP) {\n      let myTramAlive = trams.find(tram => tram.VP.veh === myTram.VP.veh)\n      return (\n        <Marker\n          icon={myTramIcon}\n          position={{ lat: myTramAlive.VP.lat, lng: myTramAlive.VP.long }}\n        >\n          {popUp(myTramAlive)}\n        </Marker>\n      )\n    }\n  }\n\n  const style = showSidebar ? { marginLeft: '20px' } : { marginLeft: '0' }\n\n  return (\n    <div id='map' style={style} title='Double-click map to set a new center'>\n      {showSidebarOpenButton && (\n        <Button\n          variant='light'\n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            zIndex: 1,\n            fontSize: 36,\n            marginTop: '4px',\n            display: showSidebar ? 'none' : '',\n          }}\n          onClick={() => openSidebar()}\n        >\n          {showSidebarOpenButton ? 'â˜°' : ''}\n        </Button>\n      )}\n      <Map\n        id='map'\n        center={center}\n        zoom={zoom}\n        onclick={() => closeSidebar()}\n        zoomControl={false}\n      >\n        <TileLayer\n          url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n          attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        />\n        {ShowChosenTrams()}\n        {stops &&\n          stops.map((stop, i) => (\n            <Marker\n              key={i}\n              icon={stop.id === myStop.id ? myStopIcon : stopIcon}\n              position={{ lat: stop.lat, lng: stop.lon }}\n            >\n              <Popup>\n                stop {i}\n                <br /> {stop.name}\n                <br /> {stop.gtfsId}\n                <br />\n              </Popup>\n            </Marker>\n          ))}\n        {showMyTram()}\n        <Marker\n          icon={pointerIcon}\n          position={{ lat: 60.170627, lng: 24.939946 }}\n        >\n          <Popup>\n            We are here! <br /> This is our position!\n          </Popup>\n        </Marker>\n      </Map>\n    </div>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    trams: state.trams,\n    showTrams: state.showTrams,\n    showSidebar: state.showSidebar,\n    showSidebarOpenButton: state.showSidebarOpenButton,\n    stops: state.stops,\n    center: state.center,\n    zoom: state.zoom,\n    myStop: state.myStop,\n    myTram: state.myTram,\n  }\n}\n\nconst mapDispatchToProps = {\n  setShowTrams,\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LeafletMap)\n"]},"metadata":{},"sourceType":"module"}