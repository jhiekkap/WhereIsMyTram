{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/App.js\";\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n      {\\n        stopsByRadius(lat: 60.170627, lon: 24.939946, radius: 300) {\\n          edges {\\n            node {\\n              stop {\\n                id\\n                gtfsId\\n                 name\\n                lat\\n                lon \\n                vehicleType\\n              }\\n            }\\n          }\\n        }\\n      }\\n      \"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { setTrams } from './reducers/tramsReducer';\nimport { setShowSidebar } from './reducers/showSidebarReducer';\nimport { setShowSidebarOpenButton } from './reducers/showSidebarOpenButtonReducer';\nimport { setStops } from './reducers/stopsReducer';\nimport { setMyStop } from './reducers/myStopReducer';\nimport './App.css';\nimport LeafletMap from './components/LeafletMap';\nimport Sidebar from './components/Sidebar';\nimport ApolloClient, { gql } from 'apollo-boost';\nimport { sortStopsByDistance } from './utils/icons';\nconst client = new ApolloClient({\n  uri: 'https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql'\n});\nconst query = gql(_templateObject());\n\nconst App = ({\n  setTrams,\n  setShowSidebar,\n  setShowSidebarOpenButton,\n  setStops //setMyStop\n\n}) => {\n  console.log('rendering App!!!!!');\n  useEffect(() => {\n    client.query({\n      query\n    }).then(response => {\n      let edges = response.data.stopsByRadius.edges;\n      let stopit = edges.map(edge => edge.node.stop).filter(stop => stop.vehicleType === 0);\n      setStops(stopit); //setMyStop(stopit[0])\n\n      console.log('EDGES: ', edges);\n      console.log('STOPIT: ', stopit);\n      edges.forEach(edge => {\n        console.log('HSL: ', edge.node.stop);\n      });\n    });\n  });\n\n  const update = () => {\n    //fetch('http://localhost:3001/trams')   \n    fetch('/trams').then(response => response.json()).then(body => {\n      setTrams(body);\n    }).catch(error => {\n      console.log(error);\n    });\n  }; //useEffect(() => update(), [new Date()])\n\n\n  setInterval(() => {\n    update();\n  }, 1000);\n\n  const openSidebar = () => {\n    setShowSidebar(true);\n    setShowSidebarOpenButton(false);\n    console.log('open!');\n  };\n\n  const closeSidebar = () => {\n    setShowSidebar(false);\n    setTimeout(() => {\n      setShowSidebarOpenButton(true);\n    }, 300);\n    console.log('close!');\n  };\n\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, React.createElement(Sidebar, {\n    closeSidebar: closeSidebar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }), React.createElement(LeafletMap, {\n    openSidebar: openSidebar,\n    closeSidebar: closeSidebar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }));\n};\n/* const mapStateToProps = state => {\n  return {\n    stops: state.stops,\n    myStop: state.myStop,\n  }\n} */\n\n\nconst mapDispatchToProps = {\n  setTrams,\n  setShowSidebar,\n  setShowSidebarOpenButton,\n  setStops // setMyStop\n\n};\nexport default connect(null, mapDispatchToProps)(App); ////////// GEOLOCATION\n\n/*   if (\"geolocation\" in navigator) {\n    console.log(\"geolocation is available\");\n  } else {\n    console.log(\"geolocation is NOT available\");\n  }\n  navigator.geolocation.getCurrentPosition(position => { \n\n    const query = gql`\n      {\n        stopsByRadius(lat: ${position.coords.latitude}, lon: ${position.coords.longitude}, radius: 1000) {\n          edges {\n            node {\n              stop {\n                id\n                gtfsId\n                 name\n                lat\n                lon \n              }\n            }\n          }\n        }\n      }\n      ` \n    client.query({ query })\n      .then((response) => {\n        let edges = response.data.stopsByRadius.edges\n        setStops(edges)\n        edges.forEach(edge => {\n          console.log('HSL: ', edge.node.stop)\n        })\n      })\n    console.log(\"STARTING LOCATION \\nlatitude: \" + position.coords.latitude + \" longitude: \" + position.coords.longitude);\n  }); */","map":{"version":3,"sources":["/Users/jarihiekkapelto/Desktop/MOOC/harjoitusTyoFullStack19/mytram/ui/src/App.js"],"names":["React","useEffect","connect","setTrams","setShowSidebar","setShowSidebarOpenButton","setStops","setMyStop","LeafletMap","Sidebar","ApolloClient","gql","sortStopsByDistance","client","uri","query","App","console","log","then","response","edges","data","stopsByRadius","stopit","map","edge","node","stop","filter","vehicleType","forEach","update","fetch","json","body","catch","error","setInterval","openSidebar","closeSidebar","setTimeout","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { setTrams } from './reducers/tramsReducer'\nimport { setShowSidebar } from './reducers/showSidebarReducer'\nimport { setShowSidebarOpenButton } from './reducers/showSidebarOpenButtonReducer'\nimport { setStops } from './reducers/stopsReducer'\nimport { setMyStop } from './reducers/myStopReducer'\nimport './App.css'\nimport LeafletMap from './components/LeafletMap'\nimport Sidebar from './components/Sidebar'\nimport ApolloClient, { gql } from 'apollo-boost'\nimport {sortStopsByDistance} from './utils/icons'\n\nconst client = new ApolloClient({\n  uri: 'https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql'\n})\n\nconst query = gql`\n      {\n        stopsByRadius(lat: 60.170627, lon: 24.939946, radius: 300) {\n          edges {\n            node {\n              stop {\n                id\n                gtfsId\n                 name\n                lat\n                lon \n                vehicleType\n              }\n            }\n          }\n        }\n      }\n      `\n\n \nconst App = ({\n  setTrams,\n  setShowSidebar,\n  setShowSidebarOpenButton, \n  setStops, \n  //setMyStop\n}) => {\n\n  console.log('rendering App!!!!!') \n \n  useEffect(() => {\n    \n    client.query({ query })\n      .then((response) => {\n        let edges = response.data.stopsByRadius.edges\n        let stopit = edges.map(edge => edge.node.stop).filter(stop => stop.vehicleType === 0)\n        setStops(stopit)\n        //setMyStop(stopit[0])\n        console.log('EDGES: ', edges)\n        console.log('STOPIT: ', stopit) \n        edges.forEach(edge => {\n          console.log('HSL: ', edge.node.stop)\n        })\n      })\n  })\n\n \n  const update = () => {\n    //fetch('http://localhost:3001/trams')   \n    fetch('/trams')\n      .then(response => response.json())\n      .then(body => {\n        setTrams(body)\n      })\n      .catch(error => {\n        console.log(error)\n      })\n  }\n\n  //useEffect(() => update(), [new Date()])\n  setInterval(() => {\n    update()\n  }, 1000)\n\n  const openSidebar = () => {\n    setShowSidebar(true)\n    setShowSidebarOpenButton(false)\n    console.log('open!')\n  }\n\n  const closeSidebar = () => {\n    setShowSidebar(false)\n    setTimeout(() => {\n      setShowSidebarOpenButton(true)\n    }, 300)\n    console.log('close!')\n  }\n\n  return (\n    <div className='App'>\n      <Sidebar\n        closeSidebar={closeSidebar} \n      />\n      <LeafletMap\n        openSidebar={openSidebar}\n        closeSidebar={closeSidebar} \n      />\n    </div>\n  )\n}\n\n/* const mapStateToProps = state => {\n  return {\n    stops: state.stops,\n    myStop: state.myStop,\n  }\n} */\n\nconst mapDispatchToProps = {\n  setTrams, setShowSidebar, setShowSidebarOpenButton, setStops,\n  // setMyStop\n}\n\nexport default connect(\n null,\n  mapDispatchToProps\n)(App)\n\n\n////////// GEOLOCATION\n\n  /*   if (\"geolocation\" in navigator) {\n      console.log(\"geolocation is available\");\n    } else {\n      console.log(\"geolocation is NOT available\");\n    }\n    navigator.geolocation.getCurrentPosition(position => { \n  \n      const query = gql`\n        {\n          stopsByRadius(lat: ${position.coords.latitude}, lon: ${position.coords.longitude}, radius: 1000) {\n            edges {\n              node {\n                stop {\n                  id\n                  gtfsId\n                   name\n                  lat\n                  lon \n                }\n              }\n            }\n          }\n        }\n        ` \n      client.query({ query })\n        .then((response) => {\n          let edges = response.data.stopsByRadius.edges\n          setStops(edges)\n          edges.forEach(edge => {\n            console.log('HSL: ', edge.node.stop)\n          })\n        })\n      console.log(\"STARTING LOCATION \\nlatitude: \" + position.coords.latitude + \" longitude: \" + position.coords.longitude);\n    }); */\n\n\n"]},"metadata":{},"sourceType":"module"}